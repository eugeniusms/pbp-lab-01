{% extends 'base.html' %}

{% block meta %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function(){
            // AJAX [GET]
            // mendapatkan barang dari json yang ada di "http://localhost:8000/wishlist/json"
            // untuk diletakkan dalam wishlist_ajax.html ini
            $.get("http://localhost:8000/wishlist/json", function(data) {
                for (let barang of data){
                    $(".daftar-barang").append(
                        `<tr>
                            <td>${barang.fields.nama_barang}</td>
                            <td>${barang.fields.harga_barang}</td>
                            <td>${barang.fields.deskripsi}</td>
                        </tr>`)
                }
            });
            // AJAX [POST]
            // saat submit-button diclick maka post ke "http://localhost:8000/wishlist/ajax/submit"
            $("#submit-button").click(function() {
                $.post("http://localhost:8000/wishlist/ajax/submit", 
                    {
                        nama_barang: $("#nama_barang").val(),
                        harga_barang: parseInt($("#harga_barang").val()),
                        deskripsi: $("#deskripsi").val()
                    } 
            )})
        });
    </script>
    <title>Wishlist Mario</title>
{% endblock meta %}

{% block content %}
<div class="wishlist text-bg-dark">
    <div class="navbar d-flex  py-3 text-bg-secondary px-4">
        <div class="align-self-center">
            <div>{{nama}}</div> 
        </div>
        <div>
            <a href="{% url 'wishlist:logout' %}">
                <button class="btn btn-danger" >
                    Logout
                </button>
            </a>
        </div>
    </div>

    <!-- FORM POST BY AJAX [POST]-->
    <form method="POST" action="">
        {% csrf_token %}
            <input type="text" name="nama_barang" id="nama_barang" placeholder="barang"  class="form-control">
            <input type="text" name="harga_barang" id="harga_barang" placeholder="harga" class="form-control">
            <input type="text" name="deskripsi" id="deskripsi" placeholder="deskripsi" class="form-control" >
            <button id="submit-button">Tambah Wishlist</button>
    </form>
</div>

<!-- DATA DARI AJAX [GET]-->
<table class="daftar-barang">
    <tr>
        <th>Nama Barang</th>
        <th>Harga Barang</th>
        <th>Deskripsi</th>
    </tr>
</table>

{% endblock content %}